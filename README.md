# ESIåŠ åˆç‰©æ¯”å°ç¨‹å¼ä½¿ç”¨èªªæ˜

## ğŸ“‹ ç¨‹å¼åŠŸèƒ½

æ­¤ç¨‹å¼ç”¨æ–¼å¾è³ªè­œæ•¸æ“šä¸­è­˜åˆ¥åŒä¸€åŒ–åˆç‰©çš„ä¸åŒåŠ åˆç‰©(Adduct)å½¢å¼ï¼Œæ”¯æ´23ç¨®å¸¸è¦‹çš„ESIåŠ åˆç‰©ã€‚

### æ ¸å¿ƒåŸç†
1. **æ»¯ç•™æ™‚é–“(RT)åˆ†çµ„**: æ‰¾å‡ºåœ¨ç›¸è¿‘æ»¯ç•™æ™‚é–“å…§çš„æ‰€æœ‰è¨Šè™Ÿ
2. **è³ªé‡å·®æ¯”å°**: è¨ˆç®—ä¸åŒm/zå€¼ä¹‹é–“çš„è³ªé‡å·®ï¼ˆå¤§æ¸›å°ï¼‰
3. **åŠ åˆç‰©è­˜åˆ¥**: å°‡è³ªé‡å·®èˆ‡å·²çŸ¥çš„åŠ åˆç‰©è³ªé‡å·®ç•°è¡¨æ¯”å°
   - PPMå®¹è¨±ç¯„åœ = ppm Ã— è¼ƒå¤§çš„m/zå€¼ / 1,000,000
   - ä¾‹å¦‚ï¼š20 ppm å° m/z 264 = Â±0.00528 Da
4. **å¤šé‡é…å°è™•ç†ï¼ˆæ–¹æ¡ˆ2ï¼‰**: 
   - **Baseæœ‰å¤šå€‹Pairå€™é¸** â†’ é¸æ“‡RTæœ€æ¥è¿‘çš„
   - **Pairæœ‰å¤šå€‹Baseå€™é¸** â†’ ä¿ç•™æ‰€æœ‰é…å°ï¼Œåˆ—å‡ºæ‰€æœ‰å¯èƒ½æ€§
   - åœ¨Adduct_Typeå’ŒMatched_Adductæ¬„ä½ä¸­ç”¨åˆ†è™Ÿ`;`åˆ†éš”
   - æŒ‰PPMèª¤å·®æ’åºï¼Œæœ€å¯èƒ½çš„é…å°åˆ—åœ¨å‰é¢
5. **çµæœè¨»è¨˜**: æ¨™ç¤ºå‡ºå¯èƒ½çš„åŠ åˆç‰©é¡å‹ä¸¦ä¿ç•™æ‰€æœ‰åŸå§‹æ¬„ä½

---

## âœ¨ ä¸»è¦ç‰¹è‰²

- âœ… **è‡ªå‹•æª”æ¡ˆè®€å–**: æ”¯æ´ Excel (.xlsx, .xls, .xlsm, .xlsb), CSV, TSV
- âœ… **æ™ºèƒ½æ¬„ä½è­˜åˆ¥**: è‡ªå‹•è­˜åˆ¥ RT, m/z, Intensity æ¬„ä½ï¼ˆæ”¯æ´å¤šç¨®åç¨±è®Šé«”ï¼‰
- âœ… **ä¿ç•™æ‰€æœ‰æ¬„ä½**: åŸå§‹æ•¸æ“šçš„æ‰€æœ‰æ¬„ä½éƒ½æœƒè¢«ä¿ç•™åœ¨çµæœä¸­
- âœ… **å®Œæ•´Excelå ±å‘Š**: è‡ªå‹•ç”ŸæˆåŒ…å«4å€‹å·¥ä½œè¡¨çš„åˆ†æå ±å‘Š
- âœ… **23ç¨®ESIåŠ åˆç‰©**: æ¶µè“‹æœ€å¸¸è¦‹çš„æ­£é›¢å­æ¨¡å¼åŠ åˆç‰©
- âœ… **ç²¾ç¢ºæ¯”å°**: å¯èª¿æ•´PPMå’ŒRTå®¹è¨±ç¯„åœ

---

## ğŸš€ å¿«é€Ÿé–‹å§‹

### å®‰è£éœ€æ±‚

```bash
pip install pandas openpyxl numpy --break-system-packages
```

### æ–¹æ³•1: ä½¿ç”¨åœ–å½¢ä»‹é¢ï¼ˆæ¨è–¦ï¼‰

**æœ€ç°¡å–®çš„ä½¿ç”¨æ–¹å¼ï¼**

1. åŸ·è¡Œç¨‹å¼:
```bash
python adduct_matcher.py
```

2. åœ¨å½ˆå‡ºçš„è¦–çª—ä¸­:
   - é»æ“Šã€Œé¸æ“‡æª”æ¡ˆã€æŒ‰éˆ•
   - é¸æ“‡ä½ çš„è³ªè­œæ•¸æ“šæª”æ¡ˆï¼ˆExcel, CSV, æˆ– TSVï¼‰
   - è¨­å®šåƒæ•¸ï¼ˆæˆ–ä½¿ç”¨é è¨­å€¼ï¼‰
   - é»æ“Šã€Œé–‹å§‹æ¯”å°ã€

3. å®Œæˆï¼çµæœæœƒè‡ªå‹•å„²å­˜ç‚º `æª”å_adduct_results.xlsx`

### æ–¹æ³•2: åœ¨ç¨‹å¼ä¸­ä½¿ç”¨

```python
from adduct_matcher import AdductMatcher

# å»ºç«‹æ¯”å°å™¨ï¼ˆé è¨­20 ppmå®¹è¨±èª¤å·®ï¼‰
matcher = AdductMatcher(ppm_tolerance=20.0)

# è™•ç†æª”æ¡ˆï¼ˆä¸€è¡Œæå®šï¼ï¼‰
results = matcher.process('ä½ çš„æª”æ¡ˆ.xlsx', rt_tolerance=0.05)
```

---

## ğŸ“ æ”¯æ´çš„æª”æ¡ˆæ ¼å¼

### Excelæ ¼å¼
- `.xlsx` (Excel 2007+)
- `.xls` (Excel 97-2003)
- `.xlsm` (Excel å•Ÿç”¨å·¨é›†)
- `.xlsb` (Excel äºŒé€²ä½)

### æ–‡å­—æ ¼å¼
- `.csv` (é€—è™Ÿåˆ†éš”)
- `.tsv` (Tabåˆ†éš”)
- `.txt` (Tabåˆ†éš”)

---

## ğŸ” è‡ªå‹•æ¬„ä½è­˜åˆ¥

ç¨‹å¼æœƒè‡ªå‹•è­˜åˆ¥ä»¥ä¸‹æ¬„ä½ï¼ˆä¸å€åˆ†å¤§å°å¯«ï¼‰:

### RT (æ»¯ç•™æ™‚é–“) - **å¿…éœ€**
å¯è­˜åˆ¥çš„æ¬„ä½åç¨±:
```
rt, RT, RT (min), RT(min)
retention time, Retention Time, Retention Time (min)
time, Time
r.t., R.T., R.T.
ä¿ç•™æ™‚é–“, æ»¯ç•™æ™‚é–“
```

### m/z (è³ªè·æ¯”) - **å¿…éœ€**
å¯è­˜åˆ¥çš„æ¬„ä½åç¨±:
```
m/z, M/Z, mz, MZ
mass, Mass
mass to charge, Mass to Charge
precursor ion m/z, Precursor m/z
è³ªé‡, è³ªè·æ¯”
```

### Intensity (å¼·åº¦) - **å¿…éœ€**
å¯è­˜åˆ¥çš„æ¬„ä½åç¨±:
```
intensity, Intensity, Int
abundance, Abundance, Abund
height, Height
area, Area
precursor ion intensity, Precursor Intensity
å¼·åº¦, å³°é«˜, å³°é¢ç©
```

**å…¶ä»–æ¬„ä½**: æ‰€æœ‰å…¶ä»–æ¬„ä½éƒ½æœƒè¢«è‡ªå‹•ä¿ç•™åœ¨çµæœä¸­

---

## ğŸ“‹ è¼¸å…¥æª”æ¡ˆæ ¼å¼

### æœ€ç°¡å–®çš„æ ¼å¼
| RT (min) | m/z      | Intensity |
|----------|----------|-----------|
| 10.99    | 242.1191 | 50000     |
| 10.99    | 264.1010 | 38000     |

### åŒ…å«é¡å¤–æ¬„ä½çš„æ ¼å¼ï¼ˆæ¨è–¦ï¼‰
| Peak ID | RT (min) | m/z      | Intensity | Area  | S/N | å…¶ä»–æ¬„ä½... |
|---------|----------|----------|-----------|-------|-----|------------|
| 10      | 10.99    | 242.1191 | 50000     | 250k  | 200 | ...        |
| 15      | 10.99    | 264.1010 | 38000     | 190k  | 150 | ...        |

**é‡é»**: 
- å¿…é ˆåŒ…å«RTã€m/zã€Intensityä¸‰å€‹æ¬„ä½
- æ¬„ä½åç¨±æœƒè‡ªå‹•è­˜åˆ¥ï¼Œä¸ç”¨æ“”å¿ƒå¤§å°å¯«æˆ–æ ¼å¼
- æ‰€æœ‰å…¶ä»–æ¬„ä½éƒ½æœƒä¿ç•™åœ¨çµæœä¸­

---

## ğŸ“Š è¼¸å‡ºçµæœ

ç¨‹å¼æœƒç”¢ç”Ÿä¸€å€‹Excelæª”æ¡ˆï¼ˆæª”å_adduct_results.xlsxï¼‰ï¼ŒåŒ…å«**å–®ä¸€å·¥ä½œè¡¨**ï¼Œä¸¦åœ¨åŸå§‹æ•¸æ“šä¸Šç›´æ¥æ¨™è¨˜é…å°çµæœï¼š

### Original_Data_Annotatedï¼ˆæ¨™è¨˜å¾Œçš„åŸå§‹æ•¸æ“šï¼‰

**æ–°å¢çš„æ¬„ä½ï¼š**
- **Adduct_Type**: åŠ åˆç‰©é¡å‹ï¼ˆ[M+H]+ æˆ–å…¶ä»–åŠ åˆç‰©ï¼‰
  - å¦‚æœæœ‰å¤šå€‹å¯èƒ½ï¼Œç”¨åˆ†è™Ÿ`;`åˆ†éš”
  - ä¾‹å¦‚ï¼š`[M+Na]+; [M+K]+`
- **Description**: é…å°èªªæ˜
  - ä¾‹å¦‚ï¼š`[M+Na]+ of Base m/z 242.1191`
  - å¤šå€‹é…å°ï¼š`[M+Na]+ of Base m/z 242.1000; [M+K]+ of Base m/z 220.0000`
- **Pair_mz**: é…å°çš„Base m/zå€¼
  - å–®ä¸€é…å°ï¼š`242.1191`
  - å¤šå€‹é…å°ï¼š`242.1000; 220.0000`ï¼ˆç”¨åˆ†è™Ÿåˆ†éš”ï¼‰
- **PPM_Error**: PPMèª¤å·®
  - å–®ä¸€é…å°ï¼š`3.50`
  - å¤šå€‹é…å°ï¼š`3.00; 5.00`ï¼ˆç”¨åˆ†è™Ÿåˆ†éš”ï¼Œå°æ‡‰Pair_mzçš„é †åºï¼‰

**è¦–è¦ºåŒ–æ¨™è¨˜ï¼š**
- âš« **é»‘è‰²å­—é«”** = [M+H]+ ä¸”æœªè¢«é…å°ï¼ˆæ²’æœ‰æ‰¾åˆ°å°æ‡‰çš„åŠ åˆç‰©ï¼‰
- ğŸ”´ **ç´…è‰²å­—é«”** = [M+H]+ ä¸”æœ‰è¢«é…å°ï¼ˆæ˜¯æŸå€‹åŠ åˆç‰©çš„Baseï¼‰
- ğŸŸ¡ **é»ƒè‰²èƒŒæ™¯** = é[M+H]+çš„åŠ åˆç‰©ï¼ˆå¦‚[M+Na]+, [M+K]+ç­‰ï¼‰

**ç¯„ä¾‹ï¼š**
å‡è¨­æœ‰ä»¥ä¸‹æ•¸æ“šï¼š
- m/z 150.0 â†’ æœªé…å°ï¼Œé¡¯ç¤ºç‚º**é»‘è‰²å­—é«”**
- m/z 242.1191 (ID: 10) é…å°åˆ° 264.1010 â†’ é¡¯ç¤ºç‚º**ç´…è‰²å­—é«”**ï¼ˆæœ‰é…å°çš„Baseï¼‰
- m/z 264.1010 (ID: 15) æ˜¯ [M+Na]+ â†’ é¡¯ç¤ºç‚º**é»ƒè‰²èƒŒæ™¯**

**å¤šé‡é…å°ç¯„ä¾‹ï¼š**
å¦‚æœä¸€å€‹Pairå¯èƒ½ä¾†è‡ªå¤šå€‹Baseï¼š
- m/z 264.1 å¯èƒ½æ˜¯ï¼š
  - m/z 242.1 çš„ [M+Na]+ï¼ˆPPM: 3.0ï¼‰
  - m/z 220.0 çš„ [M+K]+ï¼ˆPPM: 5.0ï¼‰
- å„æ¬„ä½é¡¯ç¤ºï¼š
  - `Adduct_Type`: `[M+Na]+; [M+K]+`
  - `Description`: `[M+Na]+ of Base m/z 242.1000; [M+K]+ of Base m/z 220.0000`
  - `Pair_mz`: `242.1000; 220.0000`
  - `PPM_Error`: `3.00; 5.00`
- æ‰€æœ‰è³‡è¨ŠæŒ‰PPMèª¤å·®æ’åºï¼Œæœ€å¯èƒ½çš„é…å°åˆ—åœ¨å‰é¢

åœ¨Excelä¸­ä½ å¯ä»¥ç«‹å³çœ‹å‡ºï¼š
- é»‘å­— = æ²’é…å°åˆ°åŠ åˆç‰©çš„[M+H]+
- ç´…å­— = æœ‰é…å°åˆ°åŠ åˆç‰©çš„[M+H]+ï¼ˆBaseï¼‰
- é»ƒåº• = é€™å€‹è¨Šè™Ÿæ˜¯åŠ åˆç‰©ï¼ˆå¯èƒ½ä¾†è‡ªå¤šå€‹Baseï¼‰

**å„ªé»ï¼š**
- âœ… ä¸€ç›®äº†ç„¶ï¼Œä¸éœ€è¦å°ç…§å¤šå€‹å·¥ä½œè¡¨
- âœ… ä¿ç•™æ‰€æœ‰åŸå§‹æ¬„ä½å’Œæ•¸æ“š
- âœ… å¯ä»¥ç›´æ¥åœ¨åŸå§‹æ•¸æ“šä¸Šç¯©é¸å’Œæ’åº
- âœ… è¼•é¬†è­˜åˆ¥å“ªäº›è¨Šè™Ÿæ˜¯åŠ åˆç‰©ï¼Œå¯ä»¥é¸æ“‡ç§»é™¤æˆ–ä¿ç•™

---

## âš™ï¸ åƒæ•¸èªªæ˜

### ppm_tolerance (PPMå®¹è¨±èª¤å·®)

**é è¨­å€¼**: 20 ppm

**è¨ˆç®—æ–¹å¼**: 
- ä½¿ç”¨** m/z å€¼**ä½œç‚ºåƒè€ƒ
- å®¹è¨±ç¯„åœ (Da) = ppm Ã— è¼ƒå¤§çš„m/zå€¼ / 1,000,000
- ä¾‹å¦‚ï¼šm/z 264.1010ï¼Œ20 ppm = 0.00528 Da çš„å®¹è¨±ç¯„åœ



**å¯¦éš›ç¯„ä¾‹**:
```
è¨­å®š 20 ppm:
- å°æ–¼ m/z 264.1010ï¼Œå®¹è¨±ç¯„åœ = Â±0.00528 Da
- å°æ–¼ m/z 500.0ï¼Œå®¹è¨±ç¯„åœ = Â±0.01000 Da
- è¼ƒå¤§çš„ m/z æœ‰è¼ƒå¤§çš„å®¹è¨±ç¯„åœï¼ˆç¬¦åˆå„€å™¨ç‰¹æ€§ï¼‰
```


### rt_tolerance (RTå®¹è¨±èª¤å·®)

**é è¨­å€¼**: 0.05 åˆ†é˜



## ğŸ’¡ ä½¿ç”¨ç¯„ä¾‹

### ç¯„ä¾‹1: ä½¿ç”¨åœ–å½¢ä»‹é¢ï¼ˆæœ€ç°¡å–®ï¼‰

```bash
# ç›´æ¥åŸ·è¡Œç¨‹å¼
python adduct_matcher.py

# åœ¨å½ˆå‡ºçš„è¦–çª—ä¸­:
# 1. é»æ“Šã€Œé¸æ“‡æª”æ¡ˆã€
# 2. é¸æ“‡ä½ çš„æ•¸æ“šæª”æ¡ˆ
# 3. è¨­å®šåƒæ•¸ï¼ˆå¯é¸ï¼‰
# 4. é»æ“Šã€Œé–‹å§‹æ¯”å°ã€
```

### ç¯„ä¾‹2: åŸºæœ¬ä½¿ç”¨

```python
from adduct_matcher import AdductMatcher

# å»ºç«‹æ¯”å°å™¨
matcher = AdductMatcher(ppm_tolerance=20.0)

# è™•ç†æª”æ¡ˆ
results = matcher.process(
    file_path='LC_MS_data.xlsx',
    rt_tolerance=0.05
)

# æŸ¥çœ‹æ‰¾åˆ°å¤šå°‘é…å°
print(f"æ‰¾åˆ° {len(results)} å€‹é…å°")
```

### ç¯„ä¾‹2: åŸºæœ¬ä½¿ç”¨

```python
from adduct_matcher import AdductMatcher

# å»ºç«‹æ¯”å°å™¨
matcher = AdductMatcher(ppm_tolerance=20.0)

# è™•ç†æª”æ¡ˆ
results = matcher.process(
    file_path='LC_MS_data.xlsx',
    rt_tolerance=0.05
)

# æŸ¥çœ‹æ‰¾åˆ°å¤šå°‘é…å°
print(f"æ‰¾åˆ° {len(results)} å€‹é…å°")
```

### ç¯„ä¾‹3: è‡ªè¨‚è¼¸å‡ºæª”å

```python
matcher = AdductMatcher(ppm_tolerance=20.0)

results = matcher.process(
    file_path='data.xlsx',
    rt_tolerance=0.05,
    output_file='my_results.xlsx'
)
```

### ç¯„ä¾‹3: é«˜è§£æåº¦è³ªè­œæ•¸æ“š

```python
# ä½¿ç”¨æ›´åš´æ ¼çš„åƒæ•¸
matcher = AdductMatcher(ppm_tolerance=5.0)

results = matcher.process(
    file_path='HRMS_data.xlsx',
    rt_tolerance=0.02
)
```

### ç¯„ä¾‹3: è‡ªè¨‚è¼¸å‡ºæª”å

```python
matcher = AdductMatcher(ppm_tolerance=20.0)

results = matcher.process(
    file_path='data.xlsx',
    rt_tolerance=0.05,
    output_file='my_results.xlsx'
)
```

### ç¯„ä¾‹4: é«˜è§£æåº¦è³ªè­œæ•¸æ“š

```python
# ä½¿ç”¨æ›´åš´æ ¼çš„åƒæ•¸
matcher = AdductMatcher(ppm_tolerance=5.0)

results = matcher.process(
    file_path='HRMS_data.xlsx',
    rt_tolerance=0.02
)
```

### ç¯„ä¾‹5: åˆ†æ­¥è™•ç†

```python
matcher = AdductMatcher(ppm_tolerance=20.0)

# 1. è¼‰å…¥æ•¸æ“š
df = matcher.load_data('data.xlsx')

# 2. åŸ·è¡Œé…å°
results = matcher.match_adducts(df, rt_tolerance=0.05)

# 3. å„²å­˜çµæœ
matcher.save_results(df, 'data.xlsx', results)
```

### ç¯„ä¾‹6: æ‰¹æ¬¡è™•ç†

```python
import glob
from adduct_matcher import AdductMatcher

matcher = AdductMatcher(ppm_tolerance=20.0)

for file in glob.glob('*.xlsx'):
    print(f"\nè™•ç†: {file}")
    results = matcher.process(file, rt_tolerance=0.05)
    print(f"å®Œæˆ: æ‰¾åˆ° {len(results)} å€‹é…å°")
```

---

## ğŸ“ å¯¦éš›æ‡‰ç”¨æ¡ˆä¾‹

### ä½ çš„åŸå§‹éœ€æ±‚æ¡ˆä¾‹

**è¼¸å…¥æ•¸æ“š**:
- RT = 10.99 åˆ†é˜
- m/z = 242.1191 (ID: 10)
- m/z = 264.1010 (ID: 15)

**ç¨‹å¼è™•ç†**:
1. âœ“ è­˜åˆ¥å…©è€…åœ¨ç›¸åŒRTï¼ˆå·®ç•° < 0.05åˆ†é˜ï¼‰
2. âœ“ è¨ˆç®—è³ªé‡å·®: 264.1010 - 242.1191 = 21.9819 Da
3. âœ“ æ¯”å°åŠ åˆç‰©è¡¨ï¼Œæ‰¾åˆ° [M+Na]+ ç†è«–å€¼ = 21.981944 Da
4. âœ“ è¨ˆç®—PPMèª¤å·® = 2.01 ppmï¼ˆ< 20 ppm âœ“ï¼‰
5. âœ“ æ¨™è¨»: m/z 264.1010 æ˜¯ ID 10 çš„ [M+Na]+ åŠ åˆç‰©

**è¼¸å‡ºçµæœ**:
```
Base_Peak ID: 10
Base_m/z: 242.1191
Pair_Peak ID: 15
Pair_m/z: 264.1010
Pair_Adduct: [M+Na]+
PPM_Error: 2.01
(ä»¥åŠæ‰€æœ‰å…¶ä»–åŸå§‹æ¬„ä½)
```

---

## ğŸ”§ å¸¸è¦‹å•é¡Œæ’è§£

### Q1: ç¨‹å¼ç„¡æ³•è­˜åˆ¥æˆ‘çš„æ¬„ä½

**å¯èƒ½åŸå› **: æ¬„ä½åç¨±ä¸åœ¨æ”¯æ´åˆ—è¡¨ä¸­

**è§£æ±ºæ–¹æ³•**:
1. æŸ¥çœ‹ä¸Šæ–¹"è‡ªå‹•æ¬„ä½è­˜åˆ¥"éƒ¨åˆ†çš„æ”¯æ´åç¨±
2. å°‡æ¬„ä½é‡å‘½åç‚ºæ¨™æº–åç¨±ï¼ˆä¾‹å¦‚: RT, m/z, Intensityï¼‰
3. æˆ–ä¿®æ”¹ `_find_column` æ–¹æ³•æ·»åŠ ä½ çš„æ¬„ä½åç¨±

### Q2: æ²’æœ‰æ‰¾åˆ°ä»»ä½•é…å°

**å¯èƒ½åŸå› èˆ‡è§£æ±ºæ–¹æ³•**:

1. **RTå®¹è¨±ç¯„åœå¤ªå°**
   ```python
   # å¢åŠ RTå®¹è¨±ç¯„åœ
   results = matcher.process('data.xlsx', rt_tolerance=0.2)
   ```

2. **PPMå®¹è¨±ç¯„åœå¤ªåš´æ ¼**
   ```python
   # å¢åŠ PPMå®¹è¨±ç¯„åœ
   matcher = AdductMatcher(ppm_tolerance=50.0)
   ```

3. **æ•¸æ“šä¸­æ²’æœ‰çœŸå¯¦çš„åŠ åˆç‰©**
   - æª¢æŸ¥åŸå§‹æ•¸æ“šï¼Œç¢ºèªæ˜¯å¦æœ‰ç›¸ä¼¼RTçš„è¨Šè™Ÿ
   - ç¢ºèªè³ªé‡å·®æ˜¯å¦æ¥è¿‘è¡¨ä¸­çš„åŠ åˆç‰©

### Q3: é…å°çµæœå¤ªå¤š

**è§£æ±ºæ–¹æ³•**:

1. **ä½¿ç”¨æ›´åš´æ ¼çš„åƒæ•¸**
   ```python
   matcher = AdductMatcher(ppm_tolerance=5.0)
   results = matcher.process('data.xlsx', rt_tolerance=0.02)
   ```

2. **å¾Œè™•ç†ç¯©é¸**
   ```python
   # åªä¿ç•™PPMèª¤å·® < 5 çš„çµæœ
   high_quality = results[results['PPM_Error'] < 5.0]
   
   # åªçœ‹ç‰¹å®šåŠ åˆç‰©
   na_only = results[results['Pair_Adduct'] == '[M+Na]+']
   ```

**æ³¨æ„**: ç¨‹å¼å·²è‡ªå‹•å¯¦æ–½ç­–ç•¥Aï¼Œç•¶å¤šå€‹è¨Šè™Ÿç«¶çˆ­é…å°æ™‚ï¼Œæœƒè‡ªå‹•ä¿ç•™RTæœ€æ¥è¿‘çš„é…å°ã€‚

### Q4: å¦‚æœæœ‰åŒåˆ†ç•°æ§‹ç‰©æ€éº¼è¾¦ï¼Ÿ

å¦‚æœä½ çš„æ¨£å“ä¸­å¯èƒ½æœ‰åŒåˆ†ç•°æ§‹ç‰©ï¼ˆç›¸åŒm/zä½†ä¸åŒRTï¼‰ï¼Œç¨‹å¼æœƒæ­£ç¢ºè™•ç†ï¼š
- æ¯å€‹åŒåˆ†ç•°æ§‹ç‰©æœƒè¢«è¦–ç‚ºç¨ç«‹çš„[M+H]+
- å¦‚æœå®ƒå€‘éƒ½æœ‰å°æ‡‰çš„åŠ åˆç‰©ï¼Œéƒ½æœƒè¢«æ¨™è¨˜
- ç¨‹å¼ä½¿ç”¨m/zå’ŒRTé›™é‡åˆ¤æ–·ï¼Œä¸æœƒæ··æ·†ä¸åŒRTçš„è¨Šè™Ÿ

### Q4: çµæœä¸­çœ‹ä¸åˆ°æˆ‘çš„å…¶ä»–æ¬„ä½

ç¢ºèª:
- åŸå§‹æª”æ¡ˆä¸­ç¢ºå¯¦æœ‰é€™äº›æ¬„ä½
- æª”æ¡ˆè®€å–æˆåŠŸï¼ˆæŸ¥çœ‹consoleè¼¸å‡ºçš„"ä¿ç•™å…¶ä»–æ¬„ä½"æ•¸é‡ï¼‰
- åœ¨çµæœæª”æ¡ˆçš„ Adduct_Pairs å·¥ä½œè¡¨ä¸­æŸ¥æ‰¾ Base_æ¬„ä½å å’Œ Pair_æ¬„ä½å

---

## ğŸ“ˆ æ”¯æ´çš„23ç¨®ESIåŠ åˆç‰©

| From | To | Delta (Da) |
|------|-----|-----------|
| [M+H]+ | [M+Li]+ | 6.00817839 |
| [M+H]+ | [M+NH4]+ | 17.02654909 |
| [M+H]+ | [M+Na]+ | 21.98194424 |
| [M+H]+ | [M+K]+ | 37.95588144 |
| [M+H]+ | [M+H3O]+ | 18.01056467 |
| [M+H]+ | [M+H2O+H]+ | 18.01056468 |
| [M+H]+ | [M+MeOH+H]+  | 32.02621475 |
| [M+H]+ | [M+EtOH+H]+ | 46.04186481 |
| [M+H]+ | [M+IPA+H]+ | 60.05751488 |
| [M+H]+ | [M+ACN+H]+ | 41.0265491 |
| [M+H]+ | [M+DMSO+H]+ | 78.01393599 |
| [M+H]+ | [M+H2O+Na]+ | 39.99250892 |
| [M+H]+ | [M+MeOH+Na]+ | 54.00815898 |
| [M+H]+ | [M+EtOH+Na]+ | 68.02380905 |
| [M+H]+ | [M+IPA+Na]+ | 82.03945911 |
| [M+H]+ | [M+ACN+Na]+ | 63.00849334 |
| [M+H]+ | [M+DMSO+Na]+ | 99.99588022 |
| [M+H]+ | [M+HCOOH+H]+ | 46.0054793 |
| [M+H]+ | [M+CH3COOH+H]+ | 60.02112937 |
| [M+H]+ | [M+H2CO3+H]+ | 62.00039392 |
| [M+H]+ | [M+H2SO4+H]+ | 97.96737972 |
| [M+H]+ | [M+Na+H]+ | 22.9892207 |
| [M+H]+ | [M+2Na-H]+ | 43.96388847 |

---

## ğŸ’» ç¨‹å¼æ¶æ§‹

### ä¸»è¦é¡åˆ¥: AdductMatcher

**åˆå§‹åŒ–**:
```python
AdductMatcher(ppm_tolerance=20.0)
```

**ä¸»è¦æ–¹æ³•**:

1. `load_data(file_path)`: è¼‰å…¥æ•¸æ“šä¸¦è‡ªå‹•è­˜åˆ¥æ¬„ä½
2. `match_adducts(df, rt_tolerance)`: åŸ·è¡ŒåŠ åˆç‰©æ¯”å°
3. `save_results(df, original_file, results, output_file)`: å„²å­˜çµæœ
4. `process(file_path, rt_tolerance, output_file)`: å®Œæ•´è™•ç†æµç¨‹ï¼ˆæ¨è–¦ï¼‰

---

## ğŸ¯ æœ€ä½³å¯¦è¸

1. **æ•¸æ“šé è™•ç†**: ç¢ºä¿æ•¸æ“šå“è³ªè‰¯å¥½ï¼Œç§»é™¤æ˜é¡¯çš„é›œè¨Šå³°
2. **åƒæ•¸å„ªåŒ–**: å…ˆç”¨é è¨­åƒæ•¸ï¼Œæ ¹æ“šçµæœèª¿æ•´
3. **çµæœé©—è­‰**: æª¢æŸ¥PPMèª¤å·®ï¼Œé€šå¸¸å¥½çš„é…å°åœ¨5 ppmä»¥å…§
4. **ä¿ç•™åŸå§‹æ•¸æ“š**: ç¨‹å¼æœƒè‡ªå‹•ä¿ç•™æ‰€æœ‰æ¬„ä½ï¼Œæ–¹ä¾¿å¾ŒçºŒåˆ†æ
5. **æ‰¹æ¬¡åˆ†æ**: ä½¿ç”¨ç›¸åŒåƒæ•¸è™•ç†åŒä¸€æ‰¹æ¨£å“ä»¥ä¿æŒä¸€è‡´æ€§

---

## ğŸ“ æ³¨æ„äº‹é …

1. ç¨‹å¼å‡è¨­è¼ƒå°çš„m/zç‚º [M+H]+ï¼Œè¼ƒå¤§çš„m/zç‚ºå…¶ä»–åŠ åˆç‰©
2. åªç§»é™¤ m/z â‰¤ 0 æˆ– Intensity â‰¤ 0 çš„æ•¸æ“šï¼ŒRTå…è¨±ç‚º0
3. åŒä¸€çµ„é…å°åªä¿ç•™ä¸€æ¬¡ï¼ˆæ ¹æ“š Base_m/z, Pair_m/z, Pair_Adductå»é‡ï¼‰
4. æ‰€æœ‰åŸå§‹æ¬„ä½éƒ½æœƒè¢«ä¿ç•™ä¸¦åŠ ä¸Š Base_ æˆ– Pair_ å‰ç¶´

---

## ğŸ“„ æˆæ¬Šè³‡è¨Š

æ­¤ç¨‹å¼ç”± Claude (Anthropic) å”åŠ©é–‹ç™¼  
å°ˆç‚ºè³ªè­œæ•¸æ“šåˆ†æè¨­è¨ˆ
